<app-admin-layout>
    <div class="orders-container">
        <!-- Header -->
        <div class="page-header">
            <div class="header-info">
                <h1>Gerenciar Pedidos</h1>
                <p class="subtitle">Acompanhe e atualize o status dos pedidos</p>
            </div>
            <button mat-stroked-button color="primary" (click)="loadOrders()">
                <mat-icon>refresh</mat-icon>
                Atualizar Lista
            </button>
        </div>

        <!-- Loading -->
        <div class="loading-container" *ngIf="loading()">
            <mat-spinner diameter="40"></mat-spinner>
            <span>Carregando pedidos...</span>
        </div>

        <!-- Orders Table -->
        <mat-card class="table-card" *ngIf="!loading()">
            <table mat-table [dataSource]="orders()" class="orders-table">
                <!-- ID -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>#ID</th>
                    <td mat-cell *matCellDef="let order" class="id-cell">#{{ order.id }}</td>
                </ng-container>

                <!-- Date -->
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef>Data</th>
                    <td mat-cell *matCellDef="let order">
                        {{ order.dateTime | date:'dd/MM/yyyy HH:mm' }}
                    </td>
                </ng-container>

                <!-- Customer (Assuming User info is enriched or handled) -->
                <ng-container matColumnDef="customer">
                    <th mat-header-cell *matHeaderCellDef>Cliente</th>
                    <td mat-cell *matCellDef="let order">
                        <div class="customer-info">
                            <mat-icon>person</mat-icon>
                            <span>{{ order.user?.name || 'Cliente' }}</span>
                        </div>
                    </td>
                </ng-container>

                <!-- Total -->
                <ng-container matColumnDef="total">
                    <th mat-header-cell *matHeaderCellDef>Total</th>
                    <td mat-cell *matCellDef="let order" class="total-cell">
                        {{ order.totalValue | currency:'BRL' }}
                    </td>
                </ng-container>

                <!-- Status -->
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef>Status</th>
                    <td mat-cell *matCellDef="let order">
                        <span class="status-badge" [style.background-color]="getStatusColor(order.status) + '20'"
                            [style.color]="getStatusColor(order.status)"
                            [style.border-color]="getStatusColor(order.status) + '40'">
                            {{ getStatusLabel(order.status) }}
                        </span>
                    </td>
                </ng-container>

                <!-- Actions -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>Ações</th>
                    <td mat-cell *matCellDef="let order">
                        <button mat-flat-button color="primary" class="details-btn" (click)="openDetails(order.id)">
                            Ver Detalhes
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <!-- Empty State -->
            <div class="empty-state" *ngIf="orders().length === 0">
                <mat-icon>shopping_cart_off</mat-icon>
                <h3>Nenhum pedido encontrado</h3>
            </div>
        </mat-card>
    </div>
</app-admin-layout>